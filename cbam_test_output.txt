============================= test session starts =============================
platform win32 -- Python 3.12.9, pytest-8.3.5, pluggy-1.5.0
rootdir: C:\Users\fgrv\OneDrive\Documentos\PythonProjects\doctorado\crackseg
plugins: anyio-4.9.0, hydra-core-1.3.2, cov-6.1.1, mock-3.14.0
collected 4 items

tests\model\integration\test_cbam_integration.py FFF

================================== FAILURES ===================================
_____________________ test_cbam_integration_unet_forward ______________________
tests\model\integration\test_cbam_integration.py:19: in test_cbam_integration_unet_forward
    decoder = insert_cbam_if_enabled(
src\model\factory.py:286: in insert_cbam_if_enabled
    cbam = attention_registry.instantiate(
src\model\registry.py:154: in instantiate
    return component_cls(*args, **kwargs)
src\model\components\cbam.py:137: in __init__
    self.channel_attn = ChannelAttention(in_channels, reduction)
src\model\components\cbam.py:29: in __init__
    raise ValueError(
E   ValueError: reduction must be > 0 and < in_channels (got 4 for 1)
_______________ test_cbam_integration_cnn_convlstm_unet_forward _______________
tests\model\integration\test_cbam_integration.py:44: in test_cbam_integration_cnn_convlstm_unet_forward
    decoder = insert_cbam_if_enabled(
src\model\factory.py:286: in insert_cbam_if_enabled
    cbam = attention_registry.instantiate(
src\model\registry.py:154: in instantiate
    return component_cls(*args, **kwargs)
src\model\components\cbam.py:137: in __init__
    self.channel_attn = ChannelAttention(in_channels, reduction)
src\model\components\cbam.py:29: in __init__
    raise ValueError(
E   ValueError: reduction must be > 0 and < in_channels (got 4 for 1)
___________________________ test_cbam_save_and_load ___________________________
tests\model\integration\test_cbam_integration.py:66: in test_cbam_save_and_load
    decoder = insert_cbam_if_enabled(
src\model\factory.py:286: in insert_cbam_if_enabled
    cbam = attention_registry.instantiate(
src\model\registry.py:154: in instantiate
    return component_cls(*args, **kwargs)
src\model\components\cbam.py:137: in __init__
    self.channel_attn = ChannelAttention(in_channels, reduction)
src\model\components\cbam.py:29: in __init__
    raise ValueError(
E   ValueError: reduction must be > 0 and < in_channels (got 2 for 1)
=========================== short test summary info ===========================
FAILED tests/model/integration/test_cbam_integration.py::test_cbam_integration_unet_forward
FAILED tests/model/integration/test_cbam_integration.py::test_cbam_integration_cnn_convlstm_unet_forward
FAILED tests/model/integration/test_cbam_integration.py::test_cbam_save_and_load
!!!!!!!!!!!!!!!!!!!!!!!!!! stopping after 3 failures !!!!!!!!!!!!!!!!!!!!!!!!!!
============================== 3 failed in 1.77s ==============================
