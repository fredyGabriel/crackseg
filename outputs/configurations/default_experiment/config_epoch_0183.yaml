defaults:
- /base
- _self_
model:
  _target_: crackseg.model.architectures.swinv2_cnn_aspp_unet.SwinV2CnnAsppUNet
  type: SwinV2CnnAsppUNet
  encoder:
    _target_: crackseg.model.encoder.swin_v2_adapter.SwinV2EncoderAdapter
    model_name: swinv2_tiny_window8_256
    img_size: 256
    target_img_size: 256
    in_channels: 3
  bottleneck:
    _target_: crackseg.model.components.aspp.ASPPModule
    in_channels: 768
    output_channels: 256
    dilation_rates:
    - 1
    - 6
    - 12
    - 18
    dropout_rate: 0.1
  decoder:
    _target_: crackseg.model.decoder.cnn_decoder.CNNDecoder
    in_channels: 256
    config:
      use_cbam: true
      cbam_reduction: 16
      upsample_mode: bilinear
      kernel_size: 3
      padding: 1
      upsample_scale_factor: 2
  num_classes: 1
  final_activation: sigmoid
training:
  device: cuda
  loss:
    _target_: crackseg.training.losses.focal_dice_loss.FocalDiceLoss
    config:
      _target_: crackseg.training.losses.focal_dice_loss.FocalDiceLossConfig
      focal_weight: 0.6
      dice_weight: 0.4
      focal_alpha: 0.25
      focal_gamma: 2.0
      focal_reduction: mean
      dice_smooth: 1.0
      dice_sigmoid: true
      dice_eps: 1.0e-06
      total_loss_weight: 1.0
  learning_rate: 0.0001
  epochs: 500
  batch_size: 4
  gradient_accumulation_steps: 4
  use_amp: true
  early_stopping_patience: 15
  optimizer:
    _target_: torch.optim.AdamW
    lr: 0.0001
    weight_decay: 0.01
    betas:
    - 0.9
    - 0.999
  scheduler:
    _target_: torch.optim.lr_scheduler.CosineAnnealingWarmRestarts
    T_0: 10
    T_mult: 2
    eta_min: 1.0e-06
data:
  data_root: data/unified
  image_size:
  - 256
  - 256
  train_split: 0.7
  val_split: 0.2
  test_split: 0.1
  in_memory_cache: false
  seed: 42
  use_unified_splitting: true
  dataloader:
    batch_size: 4
    num_workers: 4
    pin_memory: true
    persistent_workers: true
    prefetch_factor: 2
    drop_last: true
  transform:
    train:
      augmentations:
      - Resize:
          height: 256
          width: 256
      - RandomRotate90:
          p: 0.5
      - HorizontalFlip:
          p: 0.5
      - ShiftScaleRotate:
          shift_limit: 0.1
          scale_limit: 0.1
          rotate_limit: 15
          border_mode: 1
          p: 0.5
      - ElasticTransform:
          alpha: 50
          sigma: 5
          alpha_affine: 0
          p: 0.3
      - RandomBrightnessContrast:
          brightness_limit: 0.2
          contrast_limit: 0.2
          p: 0.5
      - CLAHE:
          p: 0.3
      - Normalize:
          mean:
          - 0.485
          - 0.456
          - 0.406
          std:
          - 0.229
          - 0.224
          - 0.225
      - ToTensorV2: {}
    val:
      augmentations:
      - Resize:
          height: 256
          width: 256
      - Normalize:
          mean:
          - 0.485
          - 0.456
          - 0.406
          std:
          - 0.229
          - 0.224
          - 0.225
      - ToTensorV2: {}
    test:
      augmentations:
      - Resize:
          height: 256
          width: 256
      - Normalize:
          mean:
          - 0.485
          - 0.456
          - 0.406
          std:
          - 0.229
          - 0.224
          - 0.225
      - ToTensorV2: {}
evaluation:
  metrics:
  - iou
  - dice
  - f1
  - precision
  - recall
  - accuracy
  threshold: 0.5
  save_predictions: true
  save_metrics: true
logging:
  log_every_n_steps: 10
  save_every_n_epochs: 5
  tensorboard: true
  wandb: false
experiment:
  name: swinv2_hybrid_focal_dice
  description: SwinV2 + ASPP + CNN hybrid architecture with Focal Dice Loss for crack
    segmentation
  tags:
  - hybrid_architecture
  - swinv2
  - aspp
  - focal_dice_loss
  - crack_segmentation
  - rtx3070ti_optimized
hardware:
  device: cuda
  memory_efficient: true
  gradient_checkpointing: false
  mixed_precision: true
  deterministic: false
random_seed: 42
deterministic_operations: false
benchmark_cudnn: true
config_metadata:
  created_at: '2025-07-24T09:21:18.294704'
  config_hash: 964cfbad97928f53
  format_version: '1.0'
environment:
  pytorch_version: 2.7.1
  python_version: 3.12.11
  platform: Windows-11-10.0.26100-SP0
  timestamp: '2025-07-24T09:21:18.302227'
  cuda_available: true
  cuda_version: available
  cuda_device_count: '1'
  cuda_device_name: NVIDIA GeForce RTX 3070 Ti Laptop GPU
